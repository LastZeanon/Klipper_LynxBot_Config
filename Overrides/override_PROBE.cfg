[gcode_macro PROBE_XY_OFFSET]
gcode:
    PROBE {% for p in params
                %}{'%s=%s ' % (p, params[p])}{%
               endfor %}

[gcode_macro PROBE]
rename_existing: PROBE_BASE
gcode:
    BED_MESH_CLEAR

    LOCK_DOCKING
    G28 X0 Y0 Z0
    ATTACH_PROBE RETURN_TO_POSITION=FALSE

    G1 X{printer["gcode_macro _VARIABLES"].bed_x / 2} Y{printer["gcode_macro _VARIABLES"].bed_y / 2} F5000

    PROBE_BASE {% for p in params
                %}{'%s=%s ' % (p, params[p])}{%
               endfor %}

    G91
    G1 Z5 F5000
    G90

    UNLOCK_DOCKING
    DOCK_PROBE RETURN_TO_POSITION=TRUE
